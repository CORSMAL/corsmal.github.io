<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="EN" lang="EN" dir="ltr" class="gr__corsmal_eecs_qmul_ac_uk">
<head profile="http://gmpg.org/xfn/11">
	<link rel="shortcut icon" href="favicon.ico" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	<title>CORSMAL: Improving filling level classification with adversarial training</title>

	<meta http-equiv="imagetoolbar" content="no">
	<meta http-equiv="KeyWords" content="code, software, CORSMAL, robotics, touch, vision, audio, signal processing, human behaviour, challenge, ICME">
	<meta name="image" property="og:image" content="images/CORSMAL_logo.png">
	<link rel="stylesheet" href="css/layout.css" type="text/css">
	<script type="text/javascript" src="js/jquery-1.4.1.min.js"></script>
	<script type="text/javascript" src="js/jquery.slidepanel.setup.js"></script>
	<script type="text/javascript" src="js/jquery-ui-1.7.2.custom.min.js"></script>
	<script type="text/javascript" src="js/jquery.tabs.setup.js"></script>

	<script type="text/javascript">
		window.TableLoader = {
			tables:{},
			register:function(table, func){
				this.tables[table] = func;
			},
			trigger:function(key){
				var self = this;

				if(this.tables[key]){
					this.tables[key]();
					this.tables[key] = function(){};

					var keys = Object.keys(this.tables);
					var index = keys.indexOf(key);

					if(index){
						this.tables[keys[index - 1]]();
						this.tables[keys[index - 1]] = function(){};
					}

					if(index < keys.length - 1){
						this.tables[keys[index + 1]]();
						this.tables[keys[index + 1]] = function(){};
					}
				}

				if(key == "theming"){
					var themes = Object.keys(this.tables).slice(-7);

					themes.forEach(function(item){
						self.trigger(item);
					})
				}
			},
			loadFirst:function(){
				first = Object.keys(this.tables)[0];

				if(first){
					this.trigger(first);
				}
			}
		}
	</script>

	<script type="text/javascript">
	var tabledata =
	[
		{trainingstrategy:"ST",c1s1:45.42.toFixed(2),c2s1:96.70.toFixed(2),c3s1:75.64.toFixed(2),c1s2:40.13.toFixed(2),c2s2:75.55.toFixed(2),c3s2:62.68.toFixed(2),c1s3:0.55.toFixed(2),c2s3:66.67.toFixed(2),c3s3:98.22.toFixed(2)},
		{trainingstrategy:"AT",c1s1:47.40.toFixed(2),c2s1:95.92.toFixed(2),c3s1:77.07.toFixed(2),c1s2:43.72.toFixed(2),c2s2:75.74.toFixed(2),c3s2:64.10.toFixed(2),c1s3:0.00.toFixed(2),c2s3:67.56.toFixed(2),c3s3:97.20.toFixed(2)},
		{trainingstrategy:"ST->FT",c1s1:68.08.toFixed(2),c2s1:92.88.toFixed(2),c3s1:77.49.toFixed(2),c1s2:62.23.toFixed(2),c2s2:68.52.toFixed(2),c3s2:64.39.toFixed(2),c1s3:96.43.toFixed(2),c2s3:62.32.toFixed(2),c3s3:86.28.toFixed(2)},
		{trainingstrategy:"ST->AFT",c1s1:61.10.toFixed(2),c2s1:86.02.toFixed(2),c3s1:71.94.toFixed(2),c1s2:53.64.toFixed(2),c2s2:66.58.toFixed(2),c3s2:58.83.toFixed(2),c1s3:90.94.toFixed(2),c2s3:57.66.toFixed(2),c3s3:81.07.toFixed(2)},
		{trainingstrategy:"AT->FT",c1s1:74.32.toFixed(2),c2s1:91.49.toFixed(2),c3s1:79.20.toFixed(2),c1s2:64.31.toFixed(2),c2s2:78.06.toFixed(2),c3s2:76.21.toFixed(2),c1s3:99.51.toFixed(2),c2s3:74.46.toFixed(2),c3s3:92.38.toFixed(2)},
		{trainingstrategy:"AT->AFT",c1s1:65.72.toFixed(2),c2s1:85.90.toFixed(2),c3s1:73.79.toFixed(2),c1s2:65.91.toFixed(2),c2s2:73.94.toFixed(2),c3s2:70.80.toFixed(2),c1s3:90.45.toFixed(2),c2s3:65.39.toFixed(2),c3s3:89.20.toFixed(2)},
	];
</script>

<script> 
  function AppearMetadata(metadata_id) {
  	var y = document.getElementsByClassName("metadata");
  	for (var i = 0; i < y.length; i ++) {
    	y[i].style.display = 'none';
		}

    var x = document.getElementById(metadata_id);
    if (x.style.display === "none") {
      x.style.display = "block";
    } else {
      x.style.display = "none";
    }
  }
</script>

<link href="benchmark/dist/css/tabulator.min.css" rel="stylesheet">
<script type="text/javascript" src="benchmark/dist/js/tabulator.min.js"></script>
<link href="https://unpkg.com/tabulator-tables@4.4.3/dist/css/tabulator.min.css" rel="stylesheet">
<script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.4.3/dist/js/tabulator.min.js"></script>

	<style type="text/css">
		/*tr:hover {background-color: #f5f5f5;}*/
		.tg  {border-collapse:collapse;border-spacing:0;}
		.tg td{border-color:black;border-style:solid;border-width:1px;overflow:hidden;padding:10px 5px;word-break:normal;}
		.tg th{border-color:black;border-style:solid;border-width:1px;font-weight:normal;font-size:14.0pt;overflow:hidden;padding:10px 5px;word-break:normal;}
		.tg .tg-km2t{border-color:#ffffff;font-weight:bold;font-size:14.0pt;text-align:left;vertical-align:top}
		.tg .tg-zv4m{border-color:#ffffff;font-size:14.0pt;text-align:left;vertical-align:top}
	</style>

</head>
<body id="top" data-gr-c-s-loaded="true">
	<div class="wrapper row1">
		<div id="header" class="clear">
			<div class="fl_left">
				<ul>
					<li>
						<p>
							<a href="index.html"><img src="images/CORSMAL_logo.png" style="padding:0px 0px 0px 0px;height:75px" alt="CORSMAL"></a>
						</p>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<!-- 2###################################################################################################### -->
	<div class="wrapper row2" ;="" style="margin-bottom: 7px;">
		<div class="rnd">
			<!-- ###### -->
			<div id="topnav">
				<ul style="margin-top: 5px;">
					<li><a href="index.html"><b>Home</b></a></li>
					<li><a href="objectives.html"><b>Objectives</b></a></li>
					<li><a href="publications.html"><b>Publications</b></a></li>
					<li><a href="blog.html"><b>Blog</b></a></li>
					<li><a href="events.html"><b>Events</b></a></li>
					<li><a href="code.html"><b>Code</b></a></li>
					<li><a href="data.html"><b>Data</b></a></li>
					<li><a href="benchmark.html"><b>Benchmark</b></a></li>
					<li><a href="challenge.html"><b>Challenge</b></a></li>
					<li class="last"><a href="team.html"><b>Team</b></a></li>
				</ul>
			</div>
			<!-- ###### -->
		</div>
	</div>
	<!-- 3####################################################################################################### -->
	<div class="wrapper row1">
		<div id="container" class="clear">
			<div id="latestnewspage" class="clear">


				<h1><p class="xmsonormal" style="text-align:center;text-justify:inter-ideograph;margin-bottom:0px"><b><span style="font-size:16.0pt">Improving filling level classification with adversarial training</span></b></p></h1>
				<p align="justify"> 
					We investigate the problem of classifying -- from a single image -- the level of content in a cup or a drinking glass. This problem is  made challenging by several ambiguities caused by transparencies, shape variations and partial occlusions, and by the availability of only small training datasets. In this paper, we tackle this problem with an appropriate strategy for transfer learning. Specifically, we use adversarial training in a generic source dataset and then refine the training with a  task-specific dataset.<br><br>
					We also discuss and experimentally evaluate several training strategies and their combination on a range of container types of the CORSMAL Containers Manipulation dataset. We show that transfer learning with adversarial training in the source domain consistently improves the classification accuracy on the test set and limits the overfitting of the classifier to specific features of the training data.
				</p>
				<div align="middle" ,="" style="margin-bottom:15px;margin-top:15px">
					<img src="images/RTL/abstract.png" style="padding:0px 0px 0px 0px;width:500px" alt="RTL diagram">
				</div>
				<br>
				<p class="xmsonormal" style="text-justify:inter-ideograph;margin-bottom:0px"><b><span style="font-size:14.0pt">Training strategies</span></b>
				<div align="middle" ,="" style="margin-bottom:15px;margin-top:15px">
					<img src="images/RTL/state_diagram.png" style="padding:0px 0px 0px 0px;width:400px" alt="Strategies">
					<br>
					<br>
					<p align="justify">
						<table  class="tg" width="100%">
							<thead>
							<th style="vertical-align: middle;width:45%">Training strategy</td>
							<th style="vertical-align: middle;">Description</td>
						</thead>
							<tr>
							<td style="vertical-align: middle;width:45%">ST<br>(Standard Training)</td>
							<td style="vertical-align: middle;">common strategy for training a classifier on a train set.</td>
						</tr>
							<tr>
							<td style="vertical-align: middle;width:45%">AT<br>(Aversarial Training)</td>
							<td style="vertical-align: middle;">standard training but with images modified with carefully crafted noise, known as adversarial perturbation.</td>
						</tr>
							<tr>
							<td style="vertical-align: middle;width:45%">ST->FT<br>(Standard Training + Fine-Tuning)</td>
							<td style="vertical-align: middle;">standard transfer learning strategy that pre-trains the parameters of a classfier on a source domain and then re-fines them on a target domain via fine-tuning.</td>
						</tr>
							<tr>
							<td style="vertical-align: middle;width:45%">ST->AFT<br>(Standard Training + Adversarial Fine-Tuning)</td>
							<td style="vertical-align: middle;">transfer learning via fine-tuning using adversarially modified images on the target domain.</td>
						</tr>
							<tr>
							<td style="vertical-align: middle;width:45%">AT->FT<br>Adversarial Training + Fine-Tuning)</td>
							<td style="vertical-align: middle;">transfer learning with adversarial training on the source domain.</td>
						</tr>
							<tr>
							<td style="vertical-align: middle;width:45%">AT->AFT<br>(Adversarial Training + Adversarial Fine-Tuning)</td>
							<td style="vertical-align: middle;">transfer learning with adversarial training on the source domain and fine-tuning with adversarially modified images on the target domain.</td>
						</tr>
						</table>
						<!-- ST (Standard Training): common strategy for training a classifier on a train set.<br>
						AT (Aversarial Training): standard training but with images modified with carefully crafted noise, known as adversarial perturbation.<br>
						ST->FT (Standard Training + Fine-Tuning): standard transfer learning strategy that pre-trains the parameters of a classfier on a source domain and then re-fines them on a target domain via fine-tuning.<br>
						ST->AFT (Standard Training + Adversarial Fine-Tuning): transfer learning via fine-tuning using adversarially modified images on the target domain.<br>
						AT->FT (Adversarial Training + Fine-Tuning): transfer learning with adversarial training on the source domain.<br>
						AT->AFT (Adversarial Training + Adversarial Fine-Tuning): transfer learning with adversarial training on the source domain and fine-tuning with adversarially modified images on the target domain..<br> -->
					</p>
					<p align="justify">
						Note that all strategies using transfer learning (ST-FT, ST->AFT, AT->FT, AT->AFT) are trained on ImageNet as source domain.
					</p>
				</div>
				<p class="xmsonormal" style="text-justify:inter-ideograph;margin-bottom:0px"><b><span style="font-size:14.0pt">Dataset</span></b>
				</p>
				<div align="middle" ,="" style="margin-bottom:15px;margin-top:15px">
					<table class="tg" width="100%">
				<tbody>
					<tr>
						<td class="tg-zv4m" style="vertical-align: middle;"> 
							<img src="images/RTL/ccm_dataset.png" style="padding:0px 0px 0px 0px;width:400px" alt="dataset">	
						</td>
						<td class="tg-zv4m" style="vertical-align: middle;text-align: center;"> 
							<img src="images/RTL/statistics.png" style="padding:0px 0px 0px 0px;width:500px" alt="dataset">	<br>
								Statistics
						</td>
					</tr>	
				</table>					
				</div>		
				<p  align="justify">
					From the <a href="containers_manip.html" target="_blank"><u>CORSMAL Container Manipulation</u></a> dataset, we consider the public videos recordings from the three fixed views and capturing cups (4) and drinking glasses (4) as containers. The containers can be transparent, translucent or opaque, while they can be empty or being filled by a person (pouring) up to 50% or 90% of the capacity of the container with transparent (water) or opaque (pasta, rice) content. As the problem is to classify the filling level from a single RGB image, we automatically sampled, followed by manual verification, 10,269 frames of containers for which the pouring process has been finalized (we exclude all frames where a person is still pouring the content).<br><br>
					To increase the variability in the sampled data, we selected frames considering that the object is completely visible or occluded by the person's hand, and under different backgrounds. For each frame, the final image is extracted by cropping only the region with the container using <a href="http://openaccess.thecvf.com/content_ICCV_2017/papers/He_Mask_R-CNN_ICCV_2017_paper.pdf"><u>Mask R-CNN</u></a> followed by manual verification. Each crop is associated to an annotation of filling type and level, hand occlusion, and transparency of the container. 
					The number of images belonging to the set of <i>red cup</i>, <i>small white cup</i>, <i>small transparent cup</i>, <i>green glass</i>, <i>wine glass</i>, <i>champagne flute</i>, <i>beer cup</i>, and <i>cocktail glass</i>, are 1,623, 1,639, 1,290, 1,566, 1,550, 1,059, 787, and 702, respectively. The number of images are 989 for empty, 3,094 for 50%, 2,871 for 90%, and 3,262 for opaque.
				</p>
				<a href="https://zenodo.org/record/4642577#.YGJnnxLTU5k" target="_blank"><u>Download images and annotations</u></a>
				<br>
				<br>
				<p class="xmsonormal" style="text-justify:inter-ideograph;margin-bottom:0px"><b><span style="font-size:14.0pt">Data splits and results</span></b>
				</p>
				<div align="middle" ,="" style="margin-bottom:15px;margin-top:15px">
					<img src="images/RTL/data_splits.png" style="padding:0px 0px 0px 0px;width:600px" alt="data_splits"><br>
					<p style="text-align: justify;">
						We split the dataset into train and test sets under three different configurations based on the container type to understand how the container shape might affect the accuracy of a classifier. Our first configuration (S1) considers the <i>champagne flute</i> in the test set to further increase the shape variability of containers not previously seen in the train set. The second configuration (S2) swaps the <i>beer cup</i> with the <i>wine glass</i> to analyze the influence of the stem when presented or not in the train set. The last configuration (S3) places all the containers with a stem in the train set, and now the test set contains only cups with no stem. Note that black lines in the above figure mean that the set of images belonging to that container are part of the train (test) set in the data split. The number of images for each container are shown in parentheses. Note the diversity in shape, color, texture, and transparency, as well as the size compared to the 1-pound coin (GBP) used as reference size.
					</p>
				</div>
				<br>
				<br>
				<div class="example-table" id="tabledata"></div>
				<script type="text/javascript">
					var table = new Tabulator("#tabledata",
					{
						// height:"150px",
						placeholder:"No Data Available",
						maxHeight:"100%",
						layout:"fitColumns",      //fit columns to width of table
						reactiveData:true, //turn on data reactivity
						data:tabledata, //load data into table
						columns:[
						{title:"Training Strategy", field:"trainingstrategy"},
	          {
	            	title:"Data split 1 (S1)",
	            	columns:[
	            		{title:"C6", field:"c1s1", width:80, sorter:"number", align:"right"},
									{title:"C7", field:"c2s1", width:80, sorter:"number", align:"right"},
									{title:"C8", field:"c3s1", width:80, sorter:"number", align:"right"},
	            	]
	            },
	            
							{//create column group
	            	title:"Data split 2 (S2)",
	            	columns:[
				          {title:"C6", field:"c1s2", width:80, sorter:"number", align:"right"},
									{title:"C5", field:"c2s2", width:80, sorter:"number", align:"right"},
									{title:"C8", field:"c3s2", width:80, sorter:"number", align:"right"},
		            ],
		          },

		          {//create column group
	            	title:"Data split 3 (S3)",
	            	columns:[
						    	{title:"C1", field:"c1s3", width:80, sorter:"number", align:"right"},
									{title:"C4", field:"c2s3", width:80, sorter:"number", align:"right"},
									{title:"C7", field:"c3s3", width:80, sorter:"number", align:"right"},
		            ],
		          },	
						],
						});
					</script>
					Legend:<br>
					C1: red cup<br>
					C4: green glass<br>
					C5: wine glass<br>
					C6: champagne flute<br>
					C7: beer cup<br>
					C8: cocktail glass<br>

					<div align="middle" ,="" style="margin-bottom:15px;margin-top:15px">
					<img src="images/RTL/accuracy_container.png" style="padding:0px 0px 0px 0px;width:100%" alt="accuracy">
				</div>
					<br><br>
				
				<p class="xmsonormal" style="text-justify:inter-ideograph;margin-bottom:0px"><b><span style="font-size:14.0pt">Related material</span></b>
				</p>
				<!-- <a href="https://ieeexplore.ieee.org/document/9054112" target="_blank"><u>Paper </u></a> -->
				<a href="https://arxiv.org/abs/2102.04057" target="_blank"><u>Pre-print (arXiv)</u></a>
				<!-- <br>
				<a href="" target="_blank"><u>Code</u></a>  (coming soon) -->
				<br>
				<a href="https://zenodo.org/record/4518951#.YEIHk_6nw5k" target="_balnk"><u>Models</u></a> (1.5 GB)<br><br>
				We provide the pre-trained models for all the six different training strategies on the 3 splits of the C-CCM dataset.
				<br>
				<br>
				<h3><span style="font-size:14.0pt"><b>Reference</b></span></h3>
				<p>
					<!-- If you use the code, please cite:<br> -->
					<b>Improving filling level classification with adversarial training</b><br>
					A. Modas, A. Xompero, R. Sanchez-Matilla, P. Frossard, and A. Cavallaro<br>
					IEEE International Conference on Image Processing (ICIP), Anchorage, Alaska, USA, 19-22 Sep 2021.
				</p>
			</div>	
		</div>
	</div>

<!-- ####################################################################################################### -->
<!-- Begin of Sponsors and Partners div -->
<div class="wrapper row1">
	<div id="header" class="clear" style="padding: 0px 0px 0px 20px;width:920px">
		<div class="fl_left" style="margin-top: 0px;">
			<ul>
				<li style="padding: 0 0 0 0">
					<p>
						<b>Sponsors</b>
						<br>
						<br>
					</p>
					<p>
						<a href="http://www.chistera.eu" TARGET = "_blank"><img src="images/chist-era_logo_crop.png" style="height:35px;" alt="Chistera logo"/></a>
						<a href="https://epsrc.ukri.org/" target="_blank"><img src="images/EPSRC_logo.png" style="padding:10px 0px 0px 10px;height:35px;margin-bottom: 10px;" alt="EPSRC logo"></a>
						<a href="http://www.agence-nationale-recherche.fr/en/" target="_blank"><img src="images/ANR_logo.png" style="padding:10px 0px 0px 10px;height:35px;margin-bottom: 10px;" alt="ANR logo"></a>
						<a href="http://www.snf.ch/en/Pages/default.aspx" target="_blank"><img src="images/FNS_logo.jpg" style="padding:10px 0px 0px 10px;height:35px;margin-bottom: 10px;" alt="FNS logo"></a>
					</p>
				</li>
			</ul>
		</div>
		<div class="fl_right" style="margin-top: 0px;">
			<ul style="margin-bottom: 0px;">
				<li style="margin: 0px 4px 0px 0; padding: 0 0px 0 0;">
					<p>
						<b>Partners</b>
						<br>
						<br>
					</p>
					<p>
						<a href="https://www.qmul.ac.uk/" target="_blank"><img src="images/QMUL_logo.jpg" alt="Queen Mary University of London" style="padding:5px 10px 0px 0px;height:45px;"></a>
						<a href="http://www.sorbonne-universite.fr/en" target="_blank">
							<img src="images/Sorbonne_University_logo.png" alt="Sorbonne University" style="padding:5px 10px 0px 0px;height:45px;">
						</a>
						<a href="https://www.epfl.ch/en/home/" target="_blank">
							<img src="images/EPFL_logo.png" alt="EPFL" style="padding:5px 0px 0px 0px;height:45px;">
						</a>
					</p>
				</li>
			</ul>
		</div>
	</div>
</div>
<!-- End of Sponsors and Partners div -->
<br><br>
<!-- ####################################################################################################### -->
<!-- <div class="clearing">&nbsp;</div>-->
<div class="wrapper bottomPg">
	<div id="copyright">
		<div id="fl_left" style="font-size:12px">
			Â© Copyright CORSMAL 2019-2022
		</div>	  
	</div>
</div>
<!-- footer -->
<!--added to clear error with content element -->
</body>
</html>
